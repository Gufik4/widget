(function(){"use strict";var DEBUG=!1,CSS=".wwr{background:#fefefe;max-height:270px;height:auto;width:auto;max-width:200px;position:fixed;bottom:50px;right:-220px;border-radius:4px;overflow:hidden;border:1px solid #eee;-webkit-transition:all .3s ease;transition:all .3s ease;z-index:1000}.wwr.o{right:10px}.wwr.o .wt{border-radius:4px;border:1px solid #d10077;background:#d10077}.wwr.o .wt svg path{fill:#fff}.wwr.l .wt{-webkit-animation:toggleOnLoad .5s ease infinite;animation:toggleOnLoad .5s ease infinite}.wwr.n .wt{-webkit-animation:bg 1s ease 5;animation:bg 1s ease 5}.wwr.n .wl span{display:inline}.wwr ul{margin:0;padding:0;overflow-y:auto;overflow-x:hidden;max-height:250px}.wwr ul li{border-bottom:1px solid #eee}.wwr ul li a{font-size:14px;line-height:14px;color:#333;display:block;padding:5px;cursor:pointer;text-decoration:none;word-break:break-all}.wwr ul li:hover{background:#fafafa}.wwr .wl{background:#44a3dd;height:30px;border-bottom:1px solid #2f4050}.wwr .wl a{display:block;color:#fff;font-size:14px;line-height:14px;cursor:pointer;padding:9px;text-decoration:none;text-align:right;-webkit-transition:all .3s ease;transition:all .3s ease}.wwr .wl a span{display:none;font-size:14px;line-height:14px;font-weight:700;-webkit-animation:blink 1s ease infinite;animation:blink 1s ease infinite}.wwr .wl a:hover{-webkit-transform:translate3d(3px,0,0);transform:translate3d(3px,0,0)}.wwr .wt{position:fixed;bottom:10px;right:10px;width:30px;height:30px;border:1px solid #eee;background:#fefefe;border-radius:50%;overflow:hidden;box-shadow:0 0 2px #ccc;z-index:1000;-webkit-transition:all .3s ease;transition:all .3s ease}.wwr .wt a{cursor:pointer}.wwr .wt a svg{padding:6px 5px}.wwr .wt:hover{border-radius:4px;border:1px solid #d10077;background:#d10077}.wwr .wt:hover svg path{fill:#fff}@-webkit-keyframes bg{0%{background:#fafafa;fill:#000;border:1px solid #d10077}50%{background:#d10077;fill:#fff}100%{background:#fefefe;fill:#000;border:1px solid #d10077}}@keyframes bg{0%{background:#fafafa;fill:#000;border:1px solid #d10077}50%{background:#d10077;fill:#fff}100%{background:#fefefe;fill:#000;border:1px solid #d10077}}@-webkit-keyframes blink{0%{opacity:1}50%{opacity:.3}100%{opacity:1}}@keyframes blink{0%{opacity:1}50%{opacity:.3}100%{opacity:1}}@-webkit-keyframes toggleOnLoad{0%{bottom:10px}50%{bottom:15px}100%{bottom:10px}}@keyframes toggleOnLoad{0%{bottom:10px}50%{bottom:15px}100%{bottom:10px}}",ICON='<?xml version="1.0" encoding="iso-8859-1"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="20px" height="20px" viewBox="0 0 356.484 356.484" style="enable-background:new 0 0 356.484 356.484;" xml:space="preserve"><g><g><path d="M293.984,7.23H62.5C28.037,7.23,0,35.268,0,69.731v142.78c0,34.463,28.037,62.5,62.5,62.5l147.443,0.001l70.581,70.58c2.392,2.393,5.588,3.662,8.842,3.662c1.61,0,3.234-0.312,4.78-0.953c4.671-1.934,7.717-6.49,7.717-11.547v-62.237c30.759-3.885,54.621-30.211,54.621-62.006V69.731C356.484,35.268,328.447,7.23,293.984,7.23z M331.484,212.512c0,20.678-16.822,37.5-37.5,37.5h-4.621c-6.903,0-12.5,5.598-12.5,12.5v44.064l-52.903-52.903c-2.344-2.345-5.522-3.661-8.839-3.661H62.5c-20.678,0-37.5-16.822-37.5-37.5V69.732c0-20.678,16.822-37.5,37.5-37.5h231.484c20.678,0,37.5,16.822,37.5,37.5V212.512z" /><path d="M270.242,95.743h-184c-6.903,0-12.5,5.596-12.5,12.5c0,6.903,5.597,12.5,12.5,12.5h184c6.903,0,12.5-5.597,12.5-12.5C282.742,101.339,277.146,95.743,270.242,95.743z" /><path d="M270.242,165.743h-184c-6.903,0-12.5,5.596-12.5,12.5s5.597,12.5,12.5,12.5h184c6.903,0,12.5-5.597,12.5-12.5S277.146,165.743,270.242,165.743z" /></g></g></svg>',PERSON_ID=$("meta[name=person_id]").attr("content"),COMPANY_TAG=$("meta[name=company_tag]").attr("content"),BASE_PATH="http://news.databridgecmms.com/api/news/"+COMPANY_TAG+"/"+PERSON_ID,renderWidget=function(e,t){if(e.length>0)if(t){var a=$(".wwr");a.find("ul").remove(),a.append("<ul></ul>"),e.map(function(e,t){a.find("ul").append('<li><a href="'+e.url+'"><span>'+(t+1)+".</span> "+e.title+"</a></div>")}),a.addClass("n"),setTimeout(function(){a.removeClass("n")},1e4)}else{$(".wwr").remove(),function(){var e=$('<style type="text/css">'+CSS+"</style>");$("head").append(e)}();var a=$("<div></div>").addClass("wwr l"),n=$('<div class="wl"><a href="http://news.databridgecmms.com/"> Read <span class="hidden">New</span> News &rarr;</a></div>'),s=$('<div class="wt"><a>'+ICON+"</a></div>");a.append(s),a.append(n),a.append("<ul></ul>"),e.map(function(e,t){a.find("ul").append('<li><a href="'+e.url+'"><span>'+(t+1)+".</span> "+e.title+"</a></div>")}),$("body").append(a),$(".wt").on("click",function(e){a.toggleClass("o"),e.preventDefault(),e.stopPropagation()}),$(document).mouseup(function(e){e.preventDefault(),e.stopPropagation(),a.is(e.target)||0!==a.has(e.target).length||a.removeClass("o")}),setTimeout(function(){a.removeClass("l")},1500)}},ajaxRequest=function(){var e=JSON.parse(localStorage.getItem("widget.time_storage"))||0,t=JSON.parse(localStorage.getItem("widget.news"))||[];Date.now()-12e5>e?(DEBUG&&console.log("widget ajax"),$.ajax({method:"GET",url:BASE_PATH}).done(function(e){DEBUG&&console.log("widget data",e.news),localStorage.setItem("widget.time_storage",Date.now()),localStorage.setItem("widget.news",JSON.stringify(e.news)),renderWidget(e.news),setInterval(function(){DEBUG&&console.log("widget interval tick"),renderWidget(e.news,!0)},12e5)}).fail(function(e){DEBUG&&console.log("widget error",e)})):(DEBUG&&console.log("widget cache",t),renderWidget(t))},init=function(){DEBUG&&console.log("widget start"),ajaxRequest()};init();})()